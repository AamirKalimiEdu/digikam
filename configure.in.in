#MIN_CONFIG(3)

AM_INIT_AUTOMAKE(digikam,0.7.0)

dnl ------------------------------------------------------------
dnl libraries needed
dnl ------------------------------------------------------------

# -----------------------------------------------------------------
# sqlite type check
# -----------------------------------------------------------------
KDE_CHECK_TYPES


#------------------------------------------------------------------
# gphoto2 detection
#------------------------------------------------------------------

dnl Check for gPhoto2 configuration

AC_PATH_PROG(GPHOTO_CONFIG,gphoto2-config)
AC_PATH_PROG(GPHOTO_PORT_CONFIG,gphoto2-port-config)
if test -n "${GPHOTO_CONFIG}"; then
  GPHOTO_CFLAGS="`$GPHOTO_CONFIG --cflags`"
  AC_SUBST(GPHOTO_CFLAGS)
  LIB_GPHOTO="`$GPHOTO_CONFIG --libs` `$GPHOTO_PORT_CONFIG --libs`"
  AC_SUBST(LIB_GPHOTO)
else
  AC_MSG_WARN([gPhoto2 not found.])
  DO_NOT_COMPILE="digikam $DO_NOT_COMPILE"
fi


CXXFLAGS="$CXXFLAGS -DQT_CLEAN_NAMESPACE"


#------------------------------------------------------------------
# KIPI support (KDE Image Plugin Interface) instead DigikamPlugins
#------------------------------------------------------------------

AC_MSG_CHECKING(if KIPI is installed)
KDE_CHECK_HEADER(libkipi/interface.h,  have_kipi=yes,  have_kipi=no)

if test "$have_kipi" = "no"; then
  AC_MSG_WARN([Can't find KIPI (KDE Image Plugin Interface)
Please install kdeextrager-libs-1 to get the most out of KimDaBa]);
   DO_NOT_COMPILE="$DO_NOT_COMPILE digikam"
fi

#------------------------------------------------------------------
# Check for Libkexif
#------------------------------------------------------------------

KDE_CHECK_HEADER(libkexif/kexif.h, have_kexif=yes, have_kexif=no)

if test "$have_kexif" = "no"; then
  AC_WARN([Can't find Libkexif headers, Digikam won't be compiled.])
  DO_NOT_COMPILE="digikam $DO_NOT_COMPILE"
else
  LIB_KEXIF="-lkexif"
  AC_SUBST(LIB_KEXIF)
fi

#------------------------------------------------------------------
# Check for gdbm
#------------------------------------------------------------------

KDE_CHECK_HEADER(gdbm.h, have_gdbm=yes, have_gdbm=no)

if test "$have_gdbm" = "no"; then
  AC_WARN([Can't find gdbm headers, Digikam won't be compiled.])
  DO_NOT_COMPILE="digikam $DO_NOT_COMPILE"
else
  LIB_GDBM="-lgdbm"
  AC_SUBST(LIB_GDBM)
fi

